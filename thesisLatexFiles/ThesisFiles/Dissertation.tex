%Sample of text file to include all the documents

\documentclass[12pt,LUDisStyle,twosided]{book}
\usepackage[hang,small,bf]{caption}
\usepackage{LUDisStyle}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{verbatim}
\usepackage{multirow}
\usepackage[square,numbers]{natbib}
\renewcommand{\topfraction}{0.95}
\renewcommand{\textfraction}{0.05}
\renewcommand{\floatpagefraction}{0.85}
\addtolength{\belowcaptionskip}{10pt}
\newcommand{\mc}{\mathcal}

\begin{document}
\pagestyle{plain}
\pagenumbering{roman}
\dissertationtrue
\include{coverCopyright}
\include{signatures}
\include{dedication}
\tableofcontents
\nopagebreak
\addcontentsline{toc}{chapter}{List of Tables}
\listoftables
\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures
\newpage
\pagestyle{plain}
\pagenumbering{arabic}
\addcontentsline{toc}{chapter}{Abstract}
\include{myabstract}
\pagestyle{plain}

\chapter{Introduction}

Variable Energy Resources (usually refereed as VERs) plays an important role in the energy grid nowadays. It is expected that in 2020, x\% of all average consumed power in United States comes from them. One of important characteristics of them is the uncertain behaviour of generation pattern. With the deregulation of the energy market and the decarbonization rules, the grid operators have the challenge to plan efficiently their non-renewable resources (such as oil, coal and gas) in order to keep satisfy grid security and reliability parameters while running the grid at a minimal cost. This work analyses the classical LP version of Economic Dispatch (known as ED) and a MIP instance of Unit Commitment(UC) under different operational constraints and VERs penetration  scenarios.

\chapter{Literature Review}


The first optimal power flow formulation was proposed by <put the guy here in 1962>

\citeauthor{connolly} reviews 68 tools to power grid planning with renewable resources, discussing at the end goals, limitations and features of 37 tools \cite{connolly}. The authors emphasize that, although all the tools are essential to an accurate power planning with renewable resources, there is no perfect tool, and it should be chosen accordingly to project goals, data limitations, horizon and other features. 

\citeauthor{yamin} discusses different techniques to solve the unit commitment and economic dispatch problems, categorizing them in deterministic, heuristic or stochastic, pointing out the computational challenges and the quality of results for each one of them \cite{yamin}. 

\citeauthor{bertsimas} proposes a two-stage robust optimization to mitigate demand and variability uncertainties to solve UC when renewable resources are a major key in the field. The authors states the advantages of the method comparing to traditional reserves planning. \cite{bertsimas}

\citeauthor{padhy} formulates the unit commitment as a general optimization problem and presents a bibliographical survey of the main techniques in the last 30 years, from exhaustive methods such as priority listing, dynamic programming, mixed integer-programming  until complex heuristics like fuzzy programming, genetic algorithms and evolutionary programming, emphasizing that these one were not exhaustively tested yet. Models can be classified according to different features, that include:

\begin{enumerate}
\item Time frame: decade, year, hour, sub hour 
\item Scale: global, national, regional, local
\item Deterministic vs stochastic
\item Optimization vs Simulation
\item Algorithmic vs Heuristic
\end{enumerate}

\citeauthor{cain} categorizes the general power flow according to 3 major categories: Power Flow (PF), Economic Dispatch (ED) and Optimal Power Flow (OPF) and describe them based on the assumptions and operational constraints, as shown in table \ref{table:PowerSystemsCat} \cite{cain}.

\citeauthor{kassakian} discusses the main changes and challenges in the power system for the next years. One of important changes is the increase of VERs, that might have substantially impacts in operating costs, primarily due to the necessity of more reserve generations with different time responses \cite{kassakian}. To mitigate it, 3 suggestions were proposed: improve wind and solar forecast techniques; expand the cooperation and interconnections among regions; reduce decision horizon and resolution levels, to capture a more realistic ramping and reserve effects.

\citeauthor{palmintier} studies the impact of UC models with expansion planning, enhancing that ignoring operating constraints on an expansion planning with VERs could provide higher operating costs and fuel emissions. \cite{palmintier}. \citeauthor{hargreaves} proposes a method that combines simulation and stochastic UC to capture precisely the challenges of expanding the capacity with VERs. \cite{hargreaves}.


Under a scenario where VERs have a considerable penetration in the power system, it is necessary to study their impact. \citeauthor{deane} evaluates the UC and ED results at different solving temporal resolutions under one year. The authors discuss that sub-hourly resolutions can deal more accurately with non-thermal inflexibilities, renewable demand variabilities and ramping behaviours than one-hour resolution \cite{deane}. 

One of the alternatives studied in the literature is the use of storage devices to stock energy when the demand is lower than the capacity and use it on an abrupt peak demand, avoiding the use of conventional generators.\citeauthor{safaei} studies different storage technologies and their impact in the emission grid at a 15 minutes time resolution, without transmission constraints and forecast errors. The main insights are that cheap storage does not have major impact in the cost of reducing the carbonization, and seasonal storage are not economically justifiable. \cite{safaei}. In the other hand, \citeauthor{harris} studies the viability of seasonal storage by analysing UC results of different storage scenarios and technologies on a city level, concluding that seasonal storage can bring operational benefits and reduce operating costs and fuel emissions in peak levels.
 
\citeauthor{dwyer} investigates the effect of storage for ED and stochastic UC plannings under a sub-hourly resolution, concluding that storage can improve system stability and reduce cyclical ramping rates for NVERs, saving operation costs. 


% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[h]
\centering
\caption{Optimal power flow categories \cite{cain}}
\label{table:PowerSystemsCat}
\begin{tabular}{|l|l|l|l|l|l|l|l|}
\hline
\multirow{3}{*}{Category} & \multirow{3}{*}{Name} & \multicolumn{5}{l|}{Constraints} & Costs \\ \cline{3-8} 
 &  & \multicolumn{2}{l|}{Voltage} & \multirow{2}{*}{Transmission} & \multirow{2}{*}{Contingency} & \multirow{2}{*}{Losses} & \multirow{2}{*}{Generator} \\ \cline{3-4}
 &  & Angle & Magnitude &  &  &  &  \\ \hline
OPF & ACOPF & x & x & x &  & x & x \\ \hline
OPF & DCOPF &  &  & x & x & x & x \\ \hline
OPF & DOPF & x & x & x &  & x &  \\ \hline
OPF & SCED & x &  & x & x & x & x \\ \hline
OPF & SCOPF & x & x & x & x & x & x \\ \hline
PF & PF &  & x &  &  & x & x \\ \hline
ED & ED &  &  &  &  & x & x \\ \hline
\end{tabular}
\end{table}


\chapter{Development}
\section{Data}

\subsection{Reliability Test System Data}

To evaluate the proposed models and compare them with the existing literature, it was necessary to use a representative dataset that could be a baseline for the power systems analysis tests. The Institute of Electrical and Electronics Engineers (IEEE) developed a dataset that could allow researchers to compare reliability evaluation techniques, known as IEEE RTS \cite{wongieee}. 

The first version was developed in 1976 with load data, known as RTS-76, and two other versions were released with data improvements, RTS-86 and RTS-96. Only the RTS-96 has production costs for generating units, a required parameter for the proposed models in this thesis.

The system is divided into 3 areas with 24 buses each, connected by high capacity transmission lines. The topology and the buses relative geographic positions are shown in figure \ref{fig:ieeetopology}.

\begin{figure} \label{fig:ieeetopology}
  \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{ieeetopology.png}
  \caption{RTS-96 topology \cite{wongieee}}
  \label{fig:boat1}
\end{figure}

The dataset describes a peak load for each bus. The absolute load in every hour is a percentage the peak load based on 3 components: the week year, the day of week an the hour of the day. The hourly peak changes according to the season and if it is in a weekend or not. For example, the peak load of bus 101 is 108MW. On 01/07 at 12:00 PM the load is:

\begin{multline}\label{loadExample}
L_{b = 108} =  (L_{yearweek = 27} = 75.5\%) \times (L_{dayofweek = friday} = 94\%) 
\\ \times (L_{hour= 12 PM} = 93\%) \times 108 = 71.28MW
\end{multline}

Figure \ref{fig:totalSystemLoadJuly} displays the total system load throughout the month of July.

\begin{figure}[h!] \label{fig:totalSystemLoadJuly}
  \includegraphics[width=\textwidth,keepaspectratio]{totalSystemLoadJuly.png}
  \caption{System Total Load over the month of July (MW)}
\end{figure}

When the models are run under a sub-hourly level,the inter-hour time periods follow the interpolation between the hours with an additional perturbation, following an uniform distribution of $[-Pr,+Pr]\%$, where $Pr$ is a parameter in the range of [0,100]. The objective is to capture the ramping behaviour of NVERs on a sub hourly level. Figure \ref{fig:perturbationDifference} shows a difference between load curve on a 60 minute and 15 minute planning level. 

\begin{figure}[h!] \label{fig:perturbationDifference}
  \includegraphics[width=\textwidth,keepaspectratio]{perturbationDifference.png}
  \caption{System Load for 5 days in July under 60 and 15 minutes level}
\end{figure}

The original RTS-96 system has 87 generators distributed across the test field, with the following generator type distribution:

\begin{itemize}
\item 27 coal/steam generators
\item 18 hydro generators
\item 24 oil/steam generators
\item 15 nuclear generators
\item 3 sync generators (not considered for this study)
\end{itemize}

The total peak load is 8550MW while the total generation capacity is 9975MW. This project assumes the following regarding the data:

\begin{itemize}
\item All the buses follow the same behaviour. Therefore they have positive correlation.
\item The load profile is the same for every year.
\item The peak load is constant and deterministic. No stochastic factor is considered in this study.
\end{itemize}


\subsection{Wind Data}

Although RTS-96 has most of necessary data for this project, it does not contain any information of renewable generatorsn. Therefore we found necessary to integrate wind and solar data in the field to build realistic results when evaluating the impact of VER's in the proposed models. The data taken was from the Electric Reliability Council of Texas - ERCOT.



\subsection{Scenarios}

\section{Models}

This thesis covers the Economic Dispatch and Unit Commitment models, developed exhaustively in the literature.

\subsection{Indices and Sets}

\begin{tabular}{ll}

$g \in \mc{G} $& Set of generators\\
$b \in \mc{B} $& Set of buses\\
$g \in \mc{G}^{NR} $& Subset of non-renewable generators\\
$g \in \mc{G}^{R} $& Subset of renewable generators \\
$gt \in \mc{GT} $& Set of generator types \\
$u \in \mc{U} $& Set of unit groups \\
$l \in \mc{L} $& Set of transmission lines \\
$rr \in \mc{RR} $& Set of reserve requirements \\
$rp \in \mc{RP} $& Set of reserve products \\
$t \in \mc{T} $& Set of time periods \\
$g \in \mc{G^{b}} $& Set of generators in each bus b \\

\end{tabular}

\subsection{Parameters}

\begin{tabular}{ll}

$D_{b,t} $& Load at bus $b$ in time $t$ \\
$C_{g} $& Generation cost for generator g (\$ / MW) $t$ \\
$S_{g} $& Start-up cost for generator g \\
$R^{up}_{g} $& Ramp up limit for generator g \\
$R^{down}_{g} $& Ramp down limit for generator g \\
$G^{max}_{g} $& Maximum generation capacity for generator g \\
$G^{min}_{g} $& Minimum generation capacity for generator g \\
$T^{min}_{l} $& Minimum transmission of transmission line l \\
$T^{max}_{l} $& Maximum transmission of transmission line l \\
$P^{R}_{g,t} $& Power generation of renewable generator g in time t\\
$U^{up}_{g} $& Minimum uptime of generator g (hours)\\
$U^{down}_{g} $& Minimum downtime of generator g (hours)\\

\end{tabular}


Note 1: The generation of renewable resources are not in the decision variables. The developed models only decides the generation for non-renewable resources. Therefore the generation is considered a deterministic parameter, not a variable in the model.

\subsection{Variables}

\begin{tabular}{ll}

$P^{NR}_{g,t} $& Power generation of non-renewable generator g in time t (MW)\\
$T_{i,j,t} $& Power transmitted from bus i to bus j in time t (MW)\\
$T^{loss}_{i,j,t} $& Power loss in transmission from bus i to bus j in time t (MW)\\
$S_{g,t} $& On/off status of generator g at time n\\
$S^{on}_{g,t} $& Start-up status of generator g at time n\\
$S^{off}_{g,t} $& Shut-down status of generator g at time n\\
$V^{-}_{b,t} $& Under generation slack variable at each bus b in time t\\
$V^{+}_{b,t} $& Over generation slack variable at each bus b in time t\\

\end{tabular}

\subsection{Models}

The economic dispatch model satisfies the load and transmission requirements at a minimum cost, following operational requirements such as generation, transmission and ramp limits. In this model, we assume that the commitment decisions has been already made.

\subsubsection{Simple Economic Dispatch Model}

\begin{subequations}\label{model:simple_ED}
\begin{alignat}{4}
min ~~& \sum_{t \in T}\sum_{g \in G^{NR}} P^{NR}_{g,t} C_{g} + \sum_{t \in T}\sum_{b \in B} V^{-}_{b,t} + \sum_{t \in T}\sum_{b \in B} V^{+}_{b,t} \label{eq:ObjectiveFunction} \\
s.t. ~~~& \sum_{t \in T} P^{NR}_{g,t} + \sum_{t \in T} P^{R}_{g,t} + \sum_{t \in T}V^{-}_{b,t} = \sum_{t \in T} D_{b,t}  + \sum_{t \in T}V^{+}_{b,t}  &~& \forall t \in T  \label{eq:loadBalanceConstraint} \\
& P^{NR}_{g,t} - P^{NR}_{g,t - 1} \leq R^{up}_{g} &~& \forall t \in T, g \in \mc{G}^{R}\label{eq:rampUpRateConstraint} \\
& P^{NR}_{g,t -1 } - P^{NR}_{g,t} \leq R^{down}_{g} &~& \forall t \in T, g \in \mc{G}^{R}\label{eq:rampDownRateConstraint} \\
& G^{min}_{g}\leq P^{NR}_{g,t} \leq G^{max}_{g} &~& \forall t \in T, g \in \mc{G}^{R}\label{eq:generationBounds}
\end{alignat} 
\end{subequations}

The constraint \ref{eq:loadBalanceConstraint} states the energy balance in every time. The constraints \ref{eq:rampDownRateConstraint} and \ref{eq:rampUpRateConstraint} states that every generator has to obey the ramp limits. The constraint \ref{eq:generationBounds} states the generation limits for each generator. The use of slack variables $V^{-}_{b,t}$ and $V^{+}_{b,t}$ is necessary to always have feasible solutions, and it is important for scenarios where there is a huge renewable penetrations, when there's an abrupt variation of generation and there is a over or under generation.   

\subsubsection{Economic Dispatch with Transmission Constraints}

In this case, the model has to consider transmission limits and losses, without transmission costs associated. The objective function \ref{eq:ObjectiveFunction} remains the same, and the constraints \ref{eq:rampUpRateConstraint}, \ref{eq:rampDownRateConstraint} and \ref{eq:generationBounds} are als used. The constraint \ref{eq:loadBalanceConstraint} is replaced by  

\begin{subequations}\label{model:edTransmissionConstraints}
\begin{alignat}{4}
&\sum_{g \in G^{b}} P^{NR}_{g,t} + \sum_{g \in G^{b}} P^{R}_{g,t} + \sum_{b^{in} \in B} T_{b^{in},b,t} + V^{-}_{b,t} = D_{b,t}  + V^{+}_{b,t} + \sum_{b^{out} \in B} T_{b,b^{out},t}  &~& \forall b \in B, t \in t \label{eq:transmissionBalanceConstraint} \\
& T^{min}_{l} \leq T_{b^{in},b^{out},t} \leq T^{max}_{l}  &~& \forall b \in B, t \in t \label{eq:transmissionLimits}
\end{alignat} 
\end{subequations}

Constraint \ref{eq:transmissionBalanceConstraint} guarantees that the energy balance is always satisfied for every bus: everything that is generated and received from other buses should be equal to what is loaded and sent throughout the line with the respective losses. If this balance is not satisfied then it is represented in the slack variables. (TODO: put lossed in the equation). The constraint \ref{eq:transmissionLimits} defines the transmission bounds for each line.

\subsubsection{Economic dispatch model with unit commitment constraints}
Unit commitment is the decision of consider the sets of generators that are turned on and off for the planned time horizon. The model includes decision variables to capture ``on'' and ``off'' states for thermal generators in each time period,along with the start-up and shut-down decisions. \citep{palmintier}. The set of constraints are added to the previous model, and the binary nature of the variables makes the problem an MIP, naturally harder to solve computationally \cite{james}. 

\begin{subequations}\label{model:ucConstraints}
\begin{alignat}{4}
& S_{g,t} = S^{on}_{g,t} - S^{off}_{g,t} + S_{g,t}  &~& \forall g \in \mc{G}^{NR} , t \in \mc{T} \label{eq:logconst} \\
& \sum_{i = t}^{t + U^{up}_{g} - 1} S_{g,t} \geq S^{on}_{g,i} U^{up}_{g} &~& \forall g \in \mc{G}^{NR}, t \in \mc{T} \label{eq:mindownt} \\
& \sum_{i = t}^{t + U^{down}_{g} - 1} (1 -S_{g,t}) \geq S^{off}_{g,i} U^{down}_{g} &~& \forall g \in \mc{G}^{NR}, t \in \mc{T} \label{eq:minupt}
\end{alignat} 
\end{subequations}

Constraint \ref{eq:logconst} specifies the logical condition between the binary variables, assuring that a generator can not be on if it was not turned on. The same is valid for turning it off. Constraints \ref{eq:mindownt} and \ref{eq:minupt} forces the generator to follow their minimum downtime and uptime periods when they are turned on or off. 


\section{Implementation}

Here write about how it was implemented, in AIMMS, put some running times in a table, some images, put a brief description about what is AIMMS and why it is used, and etc.

\chapter{Analysis}

In the analysis make all the scenario runs, describe the data.

\chapter{Conclusion}

\appendix
\chapter{Power Systems Operation Background}

\chapter{Data and Analysis}

\bibliographystyle{plainnat}
\nocite{*}
\bibliography{biblio}
%\addcontentsline{toc}{chapter}{Vita}
\include{vita}
\end{document}

